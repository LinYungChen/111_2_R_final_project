finalProject$humanResource_analysis$all <-
finalProject$data$HumanResource.csv[,c("公司代號",
"公司名稱",
"管理職女性主管佔比")]
colnames(finalProject$humanResource_analysis$all) <-
c("number","name","female_manager_percentage")
View(finalProject$humanResource_analysis$all)
finalProject$humanResource_analysis$all <-
finalProject$data$HumanResource.csv[,c("公司代號",
"公司名稱",
"管理職女性主管佔比")]
colnames(finalProject$humanResource_analysis$all) <-
c("number","name","female_manager_percentage")
finalProject$humanResource_analysis$all$female_manager_percentage <- as.numeric(
gsub("%", "",finalProject$humanResource_analysis$all$female_manager_percentage)
)
finalProject$humanResource_analysis$all$female_manager_percentage <- round(finalProject$humanResource_analysis$all$female_manager_percentage / 100, digits = 2)
View(finalProject$humanResource_analysis$all)
table(finalProject$humanResource_analysis$all$female_manager_percentage) |> View()
finalProject$humanResource_analysis$all <-
finalProject$data$HumanResource.csv[,c("公司代號",
"公司名稱",
"管理職女性主管佔比")]
colnames(finalProject$humanResource_analysis$all) <-
c("number","name","female_manager_percentage")
finalProject$humanResource_analysis$all$female_manager_percentage <- as.numeric(
gsub("%", "",finalProject$humanResource_analysis$all$female_manager_percentage)
)
finalProject$humanResource_analysis$all$female_manager_percentage <- round(finalProject$humanResource_analysis$all$female_manager_percentage / 100, digits = 2)
View(finalProject$humanResource_analysis$all)
finalProject$humanResource_analysis$femalePercentage_category <- cut(
finalProject$humanResource_analysis$all$female_manager_percentage ,
breaks = c(-Inf, 0 , 0.38, Inf),
labels = c("管理職無女性", "有設置但未達39%", "達1/3")
)
finalProject$humanResource_analysis$femalePercentage_count <-
table(finalProject$humanResource_analysis$femalePercentage_category)
finalProject$humanResource_analysis$femaleManagerOverall <-
data.frame(
Category = as.character(names(finalProject$humanResource_analysis$femalePercentage_count)),
Count = as.numeric(finalProject$humanResource_analysis$femalePercentage_count)
)
finalProject$humanResource_analysis$femalePercentage_sum <-
sum(as.numeric(finalProject$humanResource_analysis$femalePercentage_count))
finalProject$humanResource_analysis$femaleManagerOverall$Percentage <-
sprintf(
"%.1f %%", round(
finalProject$humanResource_analysis$femalePercentage_count / finalProject$humanResource_analysis$femalePercentage_sum, digits = 2) *100
)
View(finalProject$humanResource_analysis$femaleManagerOverall)
finalProject$humanResource_analysis$femalePercentage_category <- cut(
finalProject$humanResource_analysis$all$female_manager_percentage ,
breaks = c(-Inf, 0 , 0.38, Inf),
labels = c("管理職無女性", "未達39%", "超過39%")
)
finalProject$humanResource_analysis$femalePercentage_count <-
table(finalProject$humanResource_analysis$femalePercentage_category)
finalProject$humanResource_analysis$femaleManagerOverall <-
data.frame(
Category = as.character(names(finalProject$humanResource_analysis$femalePercentage_count)),
Count = as.numeric(finalProject$humanResource_analysis$femalePercentage_count)
)
finalProject$humanResource_analysis$femalePercentage_sum <-
sum(as.numeric(finalProject$humanResource_analysis$femalePercentage_count))
finalProject$humanResource_analysis$femaleManagerOverall$Percentage <-
sprintf(
"%.1f %%", round(
finalProject$humanResource_analysis$femalePercentage_count / finalProject$humanResource_analysis$femalePercentage_sum, digits = 2) *100
)
View(finalProject$humanResource_analysis$femaleManagerOverall)
finalProject$humanResource_analysis$femalePercentage_category <- cut(
finalProject$humanResource_analysis$all$female_manager_percentage ,
breaks = c(-Inf, 0 , 0.28, Inf),
labels = c("管理職無女性", "未達39%", "超過39%")
)
finalProject$humanResource_analysis$femalePercentage_count <-
table(finalProject$humanResource_analysis$femalePercentage_category)
finalProject$humanResource_analysis$femaleManagerOverall <-
data.frame(
Category = as.character(names(finalProject$humanResource_analysis$femalePercentage_count)),
Count = as.numeric(finalProject$humanResource_analysis$femalePercentage_count)
)
finalProject$humanResource_analysis$femalePercentage_sum <-
sum(as.numeric(finalProject$humanResource_analysis$femalePercentage_count))
finalProject$humanResource_analysis$femaleManagerOverall$Percentage <-
sprintf(
"%.1f %%", round(
finalProject$humanResource_analysis$femalePercentage_count / finalProject$humanResource_analysis$femalePercentage_sum, digits = 2) *100
)
View(finalProject$humanResource_analysis$femaleManagerOverall)
finalProject$humanResource_analysis$femalePercentage_category <- cut(
finalProject$humanResource_analysis$all$female_manager_percentage ,
breaks = c(-Inf, 0 , 0.38, Inf),
labels = c("管理職無女性", "未達39%", "超過39%")
)
finalProject$humanResource_analysis$femalePercentage_count <-
table(finalProject$humanResource_analysis$femalePercentage_category)
finalProject$humanResource_analysis$femaleManagerOverall <-
data.frame(
Category = as.character(names(finalProject$humanResource_analysis$femalePercentage_count)),
Count = as.numeric(finalProject$humanResource_analysis$femalePercentage_count)
)
finalProject$humanResource_analysis$femalePercentage_sum <-
sum(as.numeric(finalProject$humanResource_analysis$femalePercentage_count))
finalProject$humanResource_analysis$femaleManagerOverall$Percentage <-
sprintf(
"%.1f %%", round(
finalProject$humanResource_analysis$femalePercentage_count / finalProject$humanResource_analysis$femalePercentage_sum, digits = 2) *100
)
View(finalProject$humanResource_analysis$femaleManagerOverall)
finalProject$humanResource_analysis$femalePercentage_category <- cut(
finalProject$humanResource_analysis$all$female_manager_percentage ,
breaks = c(-Inf, 0 , 0.38, Inf),
labels = c("管理職無女性", "未達39%", "超過39%")
)
finalProject$humanResource_analysis$femalePercentage_count <-
table(finalProject$humanResource_analysis$femalePercentage_category)
finalProject$humanResource_analysis$femaleManagerOverall <-
data.frame(
Category = as.character(names(finalProject$humanResource_analysis$femalePercentage_count)),
Count = as.numeric(finalProject$humanResource_analysis$femalePercentage_count)
)
finalProject$humanResource_analysis$femalePercentage_sum <-
sum(as.numeric(finalProject$humanResource_analysis$femalePercentage_count))
finalProject$humanResource_analysis$femaleManagerOverall$Percentage <-
sprintf(
"%.1f %%", round(
finalProject$humanResource_analysis$femalePercentage_count / finalProject$humanResource_analysis$femalePercentage_sum, digits = 2) *100
)
View(finalProject$humanResource_analysis$femaleManagerOverall)
finalProject$humanResource_analysis$femalePercentage_category <- cut(
finalProject$humanResource_analysis$all$female_manager_percentage ,
breaks = c(-Inf, 0 , 0.38, Inf),
labels = c("管理職無女性", "未達39%", "超過39%")
)
finalProject$humanResource_analysis$femalePercentage_count <-
table(finalProject$humanResource_analysis$femalePercentage_category)
finalProject$humanResource_analysis$femaleManagerOverall <-
data.frame(
Category = as.character(names(finalProject$humanResource_analysis$femalePercentage_count)),
Count = as.numeric(finalProject$humanResource_analysis$femalePercentage_count)
)
finalProject$humanResource_analysis$femalePercentage_sum <-
sum(as.numeric(finalProject$humanResource_analysis$femalePercentage_count))
finalProject$humanResource_analysis$femaleManagerOverall$Percentage <-
sprintf(
"%.1f %%", round(
finalProject$humanResource_analysis$femalePercentage_count / finalProject$humanResource_analysis$femalePercentage_sum, digits = 2) *100
)
View(finalProject$humanResource_analysis$femaleManagerOverall)
finalProject$humanResource_analysis$femalePercentage_category <- cut(
finalProject$humanResource_analysis$all$female_manager_percentage ,
breaks = c(-Inf, 0 , 0.28 , 0.38, Inf),
labels = c("管理職無女性", "未達2%", "超過29%未達39%", "超過39%")
)
finalProject$humanResource_analysis$femalePercentage_count <-
table(finalProject$humanResource_analysis$femalePercentage_category)
finalProject$humanResource_analysis$femaleManagerOverall <-
data.frame(
Category = as.character(names(finalProject$humanResource_analysis$femalePercentage_count)),
Count = as.numeric(finalProject$humanResource_analysis$femalePercentage_count)
)
finalProject$humanResource_analysis$femalePercentage_sum <-
sum(as.numeric(finalProject$humanResource_analysis$femalePercentage_count))
finalProject$humanResource_analysis$femaleManagerOverall$Percentage <-
sprintf(
"%.1f %%", round(
finalProject$humanResource_analysis$femalePercentage_count / finalProject$humanResource_analysis$femalePercentage_sum, digits = 2) *100
)
View(finalProject$humanResource_analysis$femaleManagerOverall)
finalProject$humanResource_analysis$femalePercentage_category <- cut(
finalProject$humanResource_analysis$all$female_manager_percentage ,
breaks = c(-Inf, 0 , 0.28 , 0.38, Inf),
labels = c("管理職無女性", "未達29%", "超過29%未達39%", "超過39%")
)
finalProject$humanResource_analysis$femalePercentage_count <-
table(finalProject$humanResource_analysis$femalePercentage_category)
finalProject$humanResource_analysis$femaleManagerOverall <-
data.frame(
Category = as.character(names(finalProject$humanResource_analysis$femalePercentage_count)),
Count = as.numeric(finalProject$humanResource_analysis$femalePercentage_count)
)
finalProject$humanResource_analysis$femalePercentage_sum <-
sum(as.numeric(finalProject$humanResource_analysis$femalePercentage_count))
finalProject$humanResource_analysis$femaleManagerOverall$Percentage <-
sprintf(
"%.1f %%", round(
finalProject$humanResource_analysis$femalePercentage_count / finalProject$humanResource_analysis$femalePercentage_sum, digits = 2) *100
)
View(finalProject$humanResource_analysis$femaleManagerOverall)
finalProject$board_analysis$FemalePerformanceWithIndependentGood <-
finalProject$board_analysis$female_director %>%
inner_join(finalProject$board_analysis$indenpendent_director, by = "number") %>%
filter(finalProject$board_analysis$independent_director$percentage > 0.5)
finalProject$board_analysis$female_director <-
finalProject$data$Board.csv[,c("公司代號","公司名稱",
"董事席次.含獨立董事..席.",
"女性董事席次及比率.席")]
colnames(finalProject$board_analysis$female_director) <-
c("number","name","all","female")
finalProject$board_analysis$female_director$female <-
as.numeric(gsub("[^0-9.]", "",
finalProject$board_analysis$female_director$female))
### Percentage of Female
finalProject$board_analysis$female_director$percentage <-
finalProject$board_analysis$female_director$female /
finalProject$board_analysis$female_director$all
finalProject$board_analysis$female_director$percentage <-
round(finalProject$board_analysis$female_director$percentage, digits = 2)
View(finalProject$board_analysis$female_director)
finalProject$board_analysis$independent_director <-
finalProject$data$Board.csv[,c("公司代號",
"公司名稱","董事席次.含獨立董事..席.",
"獨立董事席次.席.",
"董事出席董事會出席率")]
colnames(finalProject$board_analysis$independent_director) <- c("number","name","all","independent","attend")
### Percentage of Independent
finalProject$board_analysis$independent_director$percentage <- round(
finalProject$board_analysis$independent_director$independent / finalProject$board_analysis$independent_director$all, digits = 2)
View(finalProject$board_analysis$independent_director)
finalProject$board_analysis$independentPercentage_category <- cut(finalProject$board_analysis$independent_director$percentage,
breaks = c(-Inf, 0.333, 0.499, Inf),
labels = c("小於1/3", "未過半但過1/3", "過半數"))
finalProject$board_analysis$independentPercentage_count <-
table(finalProject$board_analysis$independentPercentage_category)
finalProject$board_analysis$independentOverall <-
data.frame(
Category = as.character(names(finalProject$board_analysis$independentPercentage_count)),
Count = as.numeric(finalProject$board_analysis$independentPercentage_count)
)
### Calculate the proportion of each category
finalProject$board_analysis$independentPercentage_sum <-
sum(as.numeric(finalProject$board_analysis$independentPercentage_count))
finalProject$board_analysis$independentOverall$Percentage <-
sprintf(
"%.1f %%", round(finalProject$board_analysis$independentPercentage_count /
finalProject$board_analysis$independentPercentage_sum, digits = 2) *100
)
View(finalProject$board_analysis$independentOverall)
finalProject$board_analysis$female_director <-
finalProject$data$Board.csv[,c("公司代號","公司名稱",
"董事席次.含獨立董事..席.",
"女性董事席次及比率.席")]
colnames(finalProject$board_analysis$female_director) <-
c("number","name","all","female")
finalProject$board_analysis$female_director$female <-
as.numeric(gsub("[^0-9.]", "",
finalProject$board_analysis$female_director$female))
### Percentage of Female
finalProject$board_analysis$female_director$percentage <-
finalProject$board_analysis$female_director$female /
finalProject$board_analysis$female_director$all
finalProject$board_analysis$female_director$percentage <-
round(finalProject$board_analysis$female_director$percentage, digits = 2)
View(finalProject$board_analysis$female_director)
finalProject$board_analysis$femalePercentage_category <-
cut(finalProject$board_analysis$female_director$percentage,
breaks = c(-Inf, 0 , 0.333, Inf),
labels = c("未設置女性董事", "有設置但未達1/3", "達1/3"))
finalProject$board_analysis$femalePercentage_count <-
table(finalProject$board_analysis$femalePercentage_category)
finalProject$board_analysis$femaleOverall <-
data.frame(
Category = as.character(names(finalProject$board_analysis$femalePercentage_count)),
Count = as.numeric(finalProject$board_analysis$femalePercentage_count)
)
finalProject$board_analysis$femalePercentage_sum <-
sum(as.numeric(finalProject$board_analysis$femalePercentage_count))
finalProject$board_analysis$femaleOverall$Percentage <-
sprintf(
"%.1f %%", round(finalProject$board_analysis$femalePercentage_count /
finalProject$board_analysis$femalePercentage_sum, digits = 2) *100
)
View(finalProject$board_analysis$femaleOverall)
finalProject$board_analysis$FemalePerformanceWithIndependentGood <-
finalProject$board_analysis$female_director %>%
inner_join(finalProject$board_analysis$indenpendent_director, by = "number") %>%
filter(finalProject$board_analysis$independent_director$percentage > 0.5)
finalProject$board_analysis$BothIndependentAndFemaleReachStandard <-
finalProject$board_analysis$female_director %>%
inner_join(finalProject$board_analysis$indenpendent_director, by = "number") %>%
filter(finalProject$board_analysis$female_director$percentage > 0.333, finalProject$board_analysis$independent_director$percentage > 0.5)
finalProject$board_analysis$female_director <-
finalProject$data$Board.csv[,c("公司代號","公司名稱",
"董事席次.含獨立董事..席.",
"女性董事席次及比率.席")]
colnames(finalProject$board_analysis$female_director) <-
c("number","name","all","female")
finalProject$board_analysis$female_director$female <-
as.numeric(gsub("[^0-9.]", "",
finalProject$board_analysis$female_director$female))
### Percentage of Female
finalProject$board_analysis$female_director$percentage <-
finalProject$board_analysis$female_director$female /
finalProject$board_analysis$female_director$all
finalProject$board_analysis$female_director$percentage <-
round(finalProject$board_analysis$female_director$percentage, digits = 2)
View(finalProject$board_analysis$female_director)
finalProject$board_analysis$independent_director <-
finalProject$data$Board.csv[,c("公司代號",
"公司名稱","董事席次.含獨立董事..席.",
"獨立董事席次.席.",
"董事出席董事會出席率")]
colnames(finalProject$board_analysis$independent_director) <- c("number","name","all","independent","attend")
### Percentage of Independent
finalProject$board_analysis$independent_director$percentage <- round(
finalProject$board_analysis$independent_director$independent / finalProject$board_analysis$independent_director$all, digits = 2)
View(finalProject$board_analysis$independent_director)
finalProject$board_analysis$BothIndependentAndFemaleReachStandard <-
finalProject$board_analysis$female_director %>%
inner_join(finalProject$board_analysis$independent_director, by = "number") %>%
filter(finalProject$board_analysis$female_director$percentage > 0.333, finalProject$board_analysis$independent_director$percentage > 0.5)
View(finalProject$board_analysis$BothIndependentAndFemaleReachStandard)
finalProject$board_analysis$FemalePerformanceWithIndependentGood <-
finalProject$board_analysis$female_director %>%
inner_join(finalProject$board_analysis$independent_director, by = "number") %>%
filter(finalProject$board_analysis$independent_director$percentage > 0.5)
finalProject$board_analysis$femalePercentageWithIndependentGood_category <-
cut(finalProject$board_analysis$FemalePerformanceWithIndependentGood$percentage.x,
breaks = c(-Inf, 0 , 0.333, Inf),
labels = c("未設置女性董事", "有設置但未達1/3", "達1/3"))
finalProject$board_analysis$femalePercentageWithIndependentGood_count <-
table(finalProject$board_analysis$femalePercentageWithIndependentGood_category)
finalProject$board_analysis$femalePerformaceWithIndependentGood <-
data.frame(
Category = as.character(names(finalProject$board_analysis$femalePercentageWithIndependentGood_count)),
Count = as.numeric(finalProject$board_analysis$femalePercentageWithIndependentGood_count)
)
finalProject$board_analysis$femalePercentageWithIndependentGood_sum <-
sum(as.numeric(finalProject$board_analysis$femalePercentageWithIndependentGood_count))
finalProject$board_analysis$femalePerformaceWithIndependentGood$Percentage <-
sprintf(
"%.1f %%", round(finalProject$board_analysis$femalePercentageWithIndependentGood_count / finalProject$board_analysis$femalePercentageWithIndependentGood_sum, digits = 2) *100
)
View(finalProject$board_analysis$femalePerformaceWithIndependentGood)
finalProject$humanResource_analysis$FemalePerformanceWithFemaleManagerGood <-
finalProject$board_analysis$female_director %>%
inner_join(finalProject$humanResource_analysis$all, by = "number") %>%
filter(finalProject$communication_analysis$all$`female_manager_percentage ` > 0.38) |> View()
finalProject$humanResource_analysis$FemalePerformanceWithFemaleManagerGood <-
finalProject$board_analysis$female_director %>%
inner_join(finalProject$humanResource_analysis$all, by = "number") %>%
filter(finalProject$communication_analysis$all$`female_manager_percentage ` > 0.38)
finalProject$humanResource_analysis$FemalePerformanceWithFemaleManagerGood_category <-
cut(finalProject$humanResource_analysis$FemalePerformanceWithFemaleManagerGood$percentage,
breaks = c(-Inf, 0 , 0.333, Inf),
labels = c("未設置女性董事", "有設置但未達1/3", "達1/3"))
finalProject$humanResource_analysis$FemalePerformanceWithFemaleManagerGood_count <-
table(finalProject$humanResource_analysis$FemalePerformanceWithFemaleManagerGood_category)
finalProject$humanResource_analysis$FemalePerformanceWithFemaleManagerGood <-
data.frame(
Category = as.character(names(finalProject$humanResource_analysis$FemalePerformanceWithFemaleManagerGood_count)), Count = as.numeric(finalProject$humanResource_analysis$FemalePerformanceWithFemaleManagerGood_count)
)
finalProject$humanResource_analysis$FemalePerformanceWithFemaleManagerGood_sum <-
sum(as.numeric(finalProject$humanResource_analysis$FemalePerformanceWithFemaleManagerGood_count))
finalProject$humanResource_analysis$FemalePerformanceWithFemaleManagerGood$Percentage <-
sprintf(
"%.1f %%", round(finalProject$humanResource_analysis$FemalePerformanceWithFemaleManagerGood_count / finalProject$humanResource_analysis$FemalePerformanceWithFemaleManagerGood_sum, digits = 2) *100
)
View(finalProject$humanResource_analysis$FemalePerformanceWithFemaleManagerGood)
finalProject$humanResource_analysis$FemalePerformanceWithFemaleManagerGood <-
finalProject$board_analysis$female_director %>%
inner_join(finalProject$humanResource_analysis$all, by = "number") %>%
filter(finalProject$communication_analysis$all$`female_manager_percentage ` > 0.38) |> View()
finalProject$humanResource_analysis$FemalePerformanceWithFemaleManagerGood_category <-
cut(finalProject$humanResource_analysis$FemalePerformanceWithFemaleManagerGood$percentage,
breaks = c(-Inf, 0 , 0.333, Inf),
labels = c("未設置女性董事", "有設置但未達1/3", "達1/3")) |> View()
finalProject$humanResource_analysis$FemalePerformanceWithFemaleManagerGood_category <-
cut(finalProject$humanResource_analysis$FemalePerformanceWithFemaleManagerGood$percentage,
breaks = c(-Inf, 0 , 0.333, Inf),
labels = c("未設置女性董事", "有設置但未達1/3", "達1/3"))
finalProject$humanResource_analysis$FemalePerformanceWithFemaleManagerGood <-
finalProject$board_analysis$female_director %>%
inner_join(finalProject$humanResource_analysis$all, by = "number") %>%
filter(finalProject$communication_analysis$all$`female_manager_percentage ` > 0.38) |> View()
finalProject$humanResource_analysis$FemalePerformanceWithFemaleManagerGood <-
finalProject$board_analysis$female_director %>%
inner_join(finalProject$humanResource_analysis$all, by = "number") %>%
filter(finalProject$communication_analysis$all$`female_manager_percentage ` > 0.38)
finalProject$humanResource_analysis$FemalePerformanceWithFemaleManagerGood_category <-
cut(finalProject$humanResource_analysis$FemalePerformanceWithFemaleManagerGood$percentage,
breaks = c(-Inf, 0 , 0.333, Inf),
labels = c("未設置女性董事", "有設置但未達1/3", "達1/3"))
finalProject$humanResource_analysis$FemalePerformanceWithFemaleManagerGood_count <-
table(finalProject$humanResource_analysis$FemalePerformanceWithFemaleManagerGood_category) |> View()
finalProject$board_analysis$FemalePerformanceWithIndependentGood <-
finalProject$board_analysis$female_director %>%
inner_join(finalProject$board_analysis$independent_director, by = "number") %>%
filter(finalProject$board_analysis$independent_director$percentage > 0.5)
finalProject$board_analysis$femalePercentageWithIndependentGood_category <-
cut(finalProject$board_analysis$FemalePerformanceWithIndependentGood$percentage.x,
breaks = c(-Inf, 0 , 0.333, Inf),
labels = c("未設置女性董事", "有設置但未達1/3", "達1/3"))
finalProject$board_analysis$femalePercentageWithIndependentGood_count <-
table(finalProject$board_analysis$femalePercentageWithIndependentGood_category)
finalProject$board_analysis$femalePerformaceWithIndependentGood <-
data.frame(
Category = as.character(names(finalProject$board_analysis$femalePercentageWithIndependentGood_count)),
Count = as.numeric(finalProject$board_analysis$femalePercentageWithIndependentGood_count)
)
finalProject$board_analysis$femalePercentageWithIndependentGood_sum <-
sum(as.numeric(finalProject$board_analysis$femalePercentageWithIndependentGood_count))
finalProject$board_analysis$femalePerformaceWithIndependentGood$Percentage <-
sprintf(
"%.1f %%", round(finalProject$board_analysis$femalePercentageWithIndependentGood_count / finalProject$board_analysis$femalePercentageWithIndependentGood_sum, digits = 2) *100
)
View(finalProject$board_analysis$femalePerformaceWithIndependentGood)
finalProject$humanResource_analysis$FemalePerformanceWithFemaleManagerGood <-
finalProject$board_analysis$female_director %>%
inner_join(finalProject$humanResource_analysis$all, by = "number") %>%
filter(finalProject$communication_analysis$all$female_manager_percentage > 0.38)
finalProject$humanResource_analysis$FemalePerformanceWithFemaleManagerGood_category <-
cut(finalProject$humanResource_analysis$FemalePerformanceWithFemaleManagerGood$percentage,
breaks = c(-Inf, 0 , 0.333, Inf),
labels = c("未設置女性董事", "有設置但未達1/3", "達1/3"))
finalProject$humanResource_analysis$FemalePerformanceWithFemaleManagerGood_count <-
table(finalProject$humanResource_analysis$FemalePerformanceWithFemaleManagerGood_category)
finalProject$humanResource_analysis$FemalePerformanceWithFemaleManagerGood <-
data.frame(
Category = as.character(names(finalProject$humanResource_analysis$FemalePerformanceWithFemaleManagerGood_count)), Count = as.numeric(finalProject$humanResource_analysis$FemalePerformanceWithFemaleManagerGood_count)
)
finalProject$humanResource_analysis$FemalePerformanceWithFemaleManagerGood_sum <-
sum(as.numeric(finalProject$humanResource_analysis$FemalePerformanceWithFemaleManagerGood_count))
finalProject$humanResource_analysis$FemalePerformanceWithFemaleManagerGood$Percentage <-
sprintf(
"%.1f %%", round(finalProject$humanResource_analysis$FemalePerformanceWithFemaleManagerGood_count / finalProject$humanResource_analysis$FemalePerformanceWithFemaleManagerGood_sum, digits = 2) *100
)
View(finalProject$humanResource_analysis$FemalePerformanceWithFemaleManagerGood)
finalProject$humanResource_analysis$all <-
finalProject$data$HumanResource.csv[,c("公司代號",
"公司名稱",
"管理職女性主管佔比")]
colnames(finalProject$humanResource_analysis$all) <-
c("number","name","female_manager_percentage")
finalProject$humanResource_analysis$all$female_manager_percentage <- as.numeric(
gsub("%", "",finalProject$humanResource_analysis$all$female_manager_percentage)
)
finalProject$humanResource_analysis$all$female_manager_percentage <- round(finalProject$humanResource_analysis$all$female_manager_percentage / 100, digits = 2)
View(finalProject$humanResource_analysis$all)
finalProject$humanResource_analysis$all <-
finalProject$data$HumanResource.csv[,c("公司代號",
"公司名稱",
"管理職女性主管佔比")]
colnames(finalProject$humanResource_analysis$all) <-
c("number","name","female_manager_percentage")
finalProject$humanResource_analysis$all$female_manager_percentage <- as.numeric(
gsub("%", "",finalProject$humanResource_analysis$all$female_manager_percentage)
)
finalProject$humanResource_analysis$all$female_manager_percentage <- round(finalProject$humanResource_analysis$all$female_manager_percentage / 100, digits = 2)
View(finalProject$humanResource_analysis$all)
finalProject$humanResource_analysis$femalePercentage_category <- cut(
finalProject$humanResource_analysis$all$female_manager_percentage ,
breaks = c(-Inf, 0 , 0.28 , 0.38, Inf),
labels = c("管理職無女性", "未達29%", "超過29%未達39%", "超過39%")
)
finalProject$humanResource_analysis$femalePercentage_count <-
table(finalProject$humanResource_analysis$femalePercentage_category)
finalProject$humanResource_analysis$femaleManagerOverall <-
data.frame(
Category = as.character(names(finalProject$humanResource_analysis$femalePercentage_count)),
Count = as.numeric(finalProject$humanResource_analysis$femalePercentage_count)
)
finalProject$humanResource_analysis$femalePercentage_sum <-
sum(as.numeric(finalProject$humanResource_analysis$femalePercentage_count))
finalProject$humanResource_analysis$femaleManagerOverall$Percentage <-
sprintf(
"%.1f %%", round(
finalProject$humanResource_analysis$femalePercentage_count / finalProject$humanResource_analysis$femalePercentage_sum, digits = 2) *100
)
View(finalProject$humanResource_analysis$femaleManagerOverall)
finalProject$humanResource_analysis$FemalePerformanceWithFemaleManagerGood <-
finalProject$board_analysis$female_director %>%
inner_join(finalProject$humanResource_analysis$all, by = "number") %>%
filter(finalProject$humanResource_analysis$all$female_manager_percentage > 0.38)
finalProject$humanResource_analysis$FemalePerformanceWithFemaleManagerGood_category <-
cut(finalProject$humanResource_analysis$FemalePerformanceWithFemaleManagerGood$percentage,
breaks = c(-Inf, 0 , 0.333, Inf),
labels = c("未設置女性董事", "有設置但未達1/3", "達1/3"))
finalProject$humanResource_analysis$FemalePerformanceWithFemaleManagerGood_count <-
table(finalProject$humanResource_analysis$FemalePerformanceWithFemaleManagerGood_category)
finalProject$humanResource_analysis$FemalePerformanceWithFemaleManagerGood <-
data.frame(
Category = as.character(names(finalProject$humanResource_analysis$FemalePerformanceWithFemaleManagerGood_count)), Count = as.numeric(finalProject$humanResource_analysis$FemalePerformanceWithFemaleManagerGood_count)
)
finalProject$humanResource_analysis$FemalePerformanceWithFemaleManagerGood_sum <-
sum(as.numeric(finalProject$humanResource_analysis$FemalePerformanceWithFemaleManagerGood_count))
finalProject$humanResource_analysis$FemalePerformanceWithFemaleManagerGood$Percentage <-
sprintf(
"%.1f %%", round(finalProject$humanResource_analysis$FemalePerformanceWithFemaleManagerGood_count / finalProject$humanResource_analysis$FemalePerformanceWithFemaleManagerGood_sum, digits = 2) *100
)
View(finalProject$humanResource_analysis$FemalePerformanceWithFemaleManagerGood)
finalProject$humanResource_analysis$femalePercentage_category <- cut(
finalProject$humanResource_analysis$all$female_manager_percentage ,
breaks = c(-Inf, 0 , 0.28 , 0.38, Inf),
labels = c("管理職無女性", "未達29%", "超過29%未達39%", "超過39%")
)
finalProject$humanResource_analysis$femalePercentage_count <-
table(finalProject$humanResource_analysis$femalePercentage_category)
finalProject$humanResource_analysis$femaleManagerOverall <-
data.frame(
Category = as.character(names(finalProject$humanResource_analysis$femalePercentage_count)),
Count = as.numeric(finalProject$humanResource_analysis$femalePercentage_count)
)
finalProject$humanResource_analysis$femalePercentage_sum <-
sum(as.numeric(finalProject$humanResource_analysis$femalePercentage_count))
finalProject$humanResource_analysis$femaleManagerOverall$Percentage <-
sprintf(
"%.1f %%", round(
finalProject$humanResource_analysis$femalePercentage_count / finalProject$humanResource_analysis$femalePercentage_sum, digits = 2) *100
)
View(finalProject$humanResource_analysis$femaleManagerOverall)
